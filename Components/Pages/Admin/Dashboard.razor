@page "/admin/dashboard"
@rendermode InteractiveServer

@using StoreManagementAPI.Services
@using StoreManagementAPI.DTOs
@using StoreManagementAPI.Data
@using StoreManagementAPI.Models
@using Microsoft.EntityFrameworkCore
@using Blazorise

@inject IStatisticsService StatisticsService
@inject StoreDbContext DbContext

<PageTitle>Admin Dashboard - E-Store</PageTitle>

<div class="dashboard-container">
    <!-- Header with Refresh -->
    <div class="flex justify-between items-center mb-6">
        <div>
            <h3 class="text-2xl font-bold text-gray-900 mb-1">Dashboard Overview</h3>
            <p class="text-gray-600 mb-0">Welcome back! Here's what's happening with your store.</p>
        </div>
        <Button Color="Color.Primary" Clicked="RefreshData" Loading="@isLoading" Class="!bg-blue-600 !text-white hover:!bg-blue-700 shadow-md">
            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.SyncAlt" class="mr-2" /> Refresh
        </Button>
    </div>

    @if (isLoading)
    {
        <div class="flex items-center justify-center py-20">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
        </div>
    }
    else if (statistics != null)
    {
        <!-- Main Stats Cards Row -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Balance/Revenue Card -->
            <div class="lg:col-span-2">
                <Card class="h-full shadow-xl border border-gray-200 !bg-white">
                    <CardBody class="p-6">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <p class="text-sm text-gray-600 mb-1 font-medium">Total Revenue</p>
                                <h2 class="text-4xl font-bold text-gray-900 mb-2">
                                    $@statistics.MonthRevenue.ToString("N2")
                                </h2>
                                <div class="flex items-center gap-2">
                                    @{
                                        var trendPercent = statistics.TodayRevenue > 0 ? 
                                            Math.Round((statistics.TodayRevenue / (statistics.MonthRevenue / 30)) * 100 - 100, 1) : 0;
                                        var isPositive = trendPercent >= 0;
                                    }
                                    <span class="@(isPositive ? "bg-green-100 text-green-700" : "bg-red-100 text-red-700") px-3 py-1 rounded-full text-sm font-bold">
                                        <Icon Name="@(isPositive ? Blazorise.Icons.FontAwesome.FontAwesomeIcons.ArrowUp : Blazorise.Icons.FontAwesome.FontAwesomeIcons.ArrowDown)" class="mr-1" />
                                        @Math.Abs(trendPercent)%
                                    </span>
                                    <span class="text-gray-600 text-sm font-medium">vs daily average</span>
                                </div>
                            </div>
                            <Button Color="Color.Light" Size="Size.Small" Class="!bg-gray-100 !text-gray-900 hover:!bg-gray-200 !border-gray-300 shadow-sm">
                                View Details
                            </Button>
                        </div>

                        <!-- Revenue Chart (Bar Chart Representation) -->
                        <div class="revenue-chart mt-4">
                            <div class="flex items-end justify-between gap-2 h-48">
                                @if (statistics.RevenueByDate != null && statistics.RevenueByDate.Any())
                                {
                                    var maxRevenue = statistics.RevenueByDate.Max(r => r.Revenue);
                                    var recentData = statistics.RevenueByDate.TakeLast(12).ToList();
                                    
                                    @foreach (var item in recentData)
                                    {
                                        var heightPercent = maxRevenue > 0 ? (item.Revenue / maxRevenue) * 100 : 0;
                                        var isHighest = item.Revenue == maxRevenue;
                                        <div class="flex-1 flex flex-col items-center gap-2">
                                            <div class="relative w-full flex justify-center">
                                                @if (isHighest)
                                                {
                                                    <div class="absolute -top-8 bg-gray-900 text-white text-xs px-2 py-1 rounded whitespace-nowrap shadow-md">
                                                        $@item.Revenue.ToString("N0")
                                                    </div>
                                                }
                                                <div class="w-8 rounded-t-md transition-all hover:opacity-80 cursor-pointer @(isHighest ? "bg-blue-600" : "bg-gray-300 hover:bg-gray-400")"
                                                     style="height: @(Math.Max(heightPercent, 5))%">
                                                </div>
                                            </div>
                                            <span class="text-xs text-gray-600 font-medium">@DateTime.Parse(item.Date).ToString("MMM")</span>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <div class="w-full text-center text-gray-500">No revenue data available</div>
                                }
                            </div>
                        </div>
                    </CardBody>
                </Card>
            </div>

            <!-- Cashflow Card -->
            <div>
                <Card class="h-full shadow-xl border border-gray-200 !bg-white">
                    <CardBody class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <p class="text-sm text-gray-600 mb-0 font-medium">Cashflow</p>
                            <a href="/admin/reports" class="text-blue-600 text-sm hover:underline font-bold">View more</a>
                        </div>
                        
                        <h3 class="text-3xl font-bold text-gray-900 mb-6">
                            $@statistics.YearRevenue.ToString("N2")
                        </h3>

                        <!-- Circular Progress -->
                        <div class="flex justify-center mb-6">
                            <div class="relative w-32 h-32">
                                <svg class="w-full h-full transform -rotate-90">
                                    <circle cx="64" cy="64" r="56" stroke="#e5e7eb" stroke-width="12" fill="none" />
                                    <circle cx="64" cy="64" r="56" stroke="#22c55e" stroke-width="12" fill="none"
                                            stroke-dasharray="352" stroke-dashoffset="88" stroke-linecap="round" />
                                    <circle cx="64" cy="64" r="56" stroke="#f97316" stroke-width="12" fill="none"
                                            stroke-dasharray="352" stroke-dashoffset="264" stroke-linecap="round" 
                                            transform="rotate(270 64 64)" />
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-2xl font-bold text-gray-900">75%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Stats -->
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                    <span class="text-sm text-gray-900 font-bold">Income</span>
                                </div>
                                <div class="text-right">
                                    <span class="font-bold text-gray-900">$@statistics.MonthRevenue.ToString("N2")</span>
                                    <span class="text-green-600 text-xs ml-2 font-bold">↑ 3%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-orange-500"></div>
                                    <span class="text-sm text-gray-900 font-bold">Expenses</span>
                                </div>
                                <div class="text-right">
                                    <span class="font-bold text-gray-900">$@((statistics.MonthRevenue * 0.25m).ToString("N2"))</span>
                                    <span class="text-orange-600 text-xs ml-2 font-bold">↑ 3%</span>
                                </div>
                            </div>
                        </div>
                    </CardBody>
                </Card>
            </div>
        </div>

        <!-- Second Row: Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
            <!-- Today's Orders -->
            <Card class="shadow-xl border border-gray-200 hover:shadow-2xl transition-shadow !bg-white">
                <CardBody class="p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1 font-bold">Today's Orders</p>
                            <h3 class="text-3xl font-bold text-gray-900 mb-0">@statistics.TodayOrders</h3>
                        </div>
                        <div class="w-12 h-12 bg-blue-500 rounded-2xl flex items-center justify-center shadow-lg">
                            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.ShoppingCart" class="text-white text-lg" />
                        </div>
                    </div>
                    <div class="mt-4">
                        <Progress Value="@GetProgressValue(statistics.TodayOrders, statistics.MonthOrders)" Color="Color.Primary" class="h-2 rounded-full" />
                    </div>
                </CardBody>
            </Card>

            <!-- Month Orders -->
            <Card class="shadow-xl border border-gray-200 hover:shadow-2xl transition-shadow !bg-white">
                <CardBody class="p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1 font-bold">Month Orders</p>
                            <h3 class="text-3xl font-bold text-gray-900 mb-0">@statistics.MonthOrders</h3>
                        </div>
                        <div class="w-12 h-12 bg-green-500 rounded-2xl flex items-center justify-center shadow-lg">
                            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.FileAlt" class="text-white text-lg" />
                        </div>
                    </div>
                    <div class="mt-4">
                        <Progress Value="75" Color="Color.Success" class="h-2 rounded-full" />
                    </div>
                </CardBody>
            </Card>

            <!-- Active Customers -->
            <Card class="shadow-xl border border-gray-200 hover:shadow-2xl transition-shadow !bg-white">
                <CardBody class="p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1 font-bold">Active Customers</p>
                            <h3 class="text-3xl font-bold text-gray-900 mb-0">@statistics.ActiveCustomers</h3>
                        </div>
                        <div class="w-12 h-12 bg-purple-500 rounded-2xl flex items-center justify-center shadow-lg">
                            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.Users" class="text-white text-lg" />
                        </div>
                    </div>
                    <div class="mt-4">
                        <Progress Value="@GetProgressValue(statistics.ActiveCustomers, statistics.TotalCustomers)" Color="Color.Info" class="h-2 rounded-full" />
                    </div>
                </CardBody>
            </Card>

            <!-- Low Stock Alert -->
            <Card class="shadow-xl border border-gray-200 hover:shadow-2xl transition-shadow !bg-white">
                <CardBody class="p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1 font-bold">Low Stock Items</p>
                            <h3 class="text-3xl font-bold text-gray-900 mb-0">@statistics.LowStockProducts</h3>
                        </div>
                        <div class="w-12 h-12 bg-red-500 rounded-2xl flex items-center justify-center shadow-lg">
                            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.ExclamationTriangle" class="text-white text-lg" />
                        </div>
                    </div>
                    <div class="mt-4">
                        <Progress Value="@GetProgressValue(statistics.LowStockProducts, statistics.TotalProducts)" Color="Color.Danger" class="h-2 rounded-full" />
                    </div>
                </CardBody>
            </Card>
        </div>

        <!-- Third Row: Chart and Top Products -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Spend Activity Chart -->
            <div class="lg:col-span-2">
                <Card class="shadow-xl border border-gray-200 !bg-white">
                    <div class="bg-white border-b border-gray-200 p-6 pb-4">
                        <div class="flex justify-between items-center">
                            <h5 class="text-lg font-bold text-gray-900 mb-0">Spend Activity</h5>
                            <div class="flex items-center gap-4">
                                <div class="flex gap-2">
                                    <Button Color="Color.Light" Size="Size.Small" Class="@GetChartButtonClass("revenue")" Clicked='() => chartView = "revenue"'>
                                        <span class="text-gray-900 font-medium">Spend and revenue</span>
                                    </Button>
                                    <Button Color="Color.Light" Size="Size.Small" Class="@GetChartButtonClass("orders")" Clicked='() => chartView = "orders"'>
                                        <span class="text-gray-900 font-medium">Spend by merchant</span>
                                    </Button>
                                </div>
                                <Button Color="Color.Light" Size="Size.Small" Class="!border-gray-300 shadow-sm">
                                    <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.SlidersH" class="mr-1 text-gray-900" /> Filters
                                </Button>
                            </div>
                        </div>
                        <div class="flex items-center gap-6 mt-4">
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <span class="text-sm text-gray-900 font-bold">Spend</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <span class="text-sm text-gray-900 font-bold">Revenue</span>
                            </div>
                        </div>
                    </div>
                    <CardBody class="p-6 bg-white">
                        <!-- Line Chart Representation -->
                        <div class="chart-container h-64 relative">
                            @if (statistics.RevenueByDate != null && statistics.RevenueByDate.Any())
                            {
                                <svg class="w-full h-full" viewBox="0 0 800 200" preserveAspectRatio="none">
                                    @{
                                        var data = statistics.RevenueByDate.TakeLast(30).ToList();
                                        var maxVal = data.Max(d => d.Revenue);
                                        var points = new List<string>();
                                        var expensePoints = new List<string>();
                                        
                                        for (int i = 0; i < data.Count; i++)
                                        {
                                            var x = (i / (float)(data.Count - 1)) * 780 + 10;
                                            var y = 190 - (float)(data[i].Revenue / maxVal) * 170;
                                            var expenseY = 190 - (float)(data[i].Revenue * 0.3m / maxVal) * 170;
                                            points.Add($"{x},{y}");
                                            expensePoints.Add($"{x},{expenseY}");
                                        }
                                    }
                                    
                                    <!-- Grid Lines -->
                                    <line x1="10" y1="50" x2="790" y2="50" stroke="#e5e7eb" stroke-dasharray="5,5" />
                                    <line x1="10" y1="100" x2="790" y2="100" stroke="#e5e7eb" stroke-dasharray="5,5" />
                                    <line x1="10" y1="150" x2="790" y2="150" stroke="#e5e7eb" stroke-dasharray="5,5" />
                                    
                                    <!-- Expense Line (Red) -->
                                    <polyline fill="none" stroke="#ef4444" stroke-width="3" points="@string.Join(" ", expensePoints)" />
                                    
                                    <!-- Revenue Line (Green) -->
                                    <polyline fill="none" stroke="#22c55e" stroke-width="3" points="@string.Join(" ", points)" />
                                    
                                    <!-- Revenue Area Fill -->
                                    <polygon fill="url(#greenGradient)" opacity="0.1" points="10,190 @string.Join(" ", points) 790,190" />
                                    
                                    <defs>
                                        <linearGradient id="greenGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                            <stop offset="0%" style="stop-color:#22c55e;stop-opacity:0.3" />
                                            <stop offset="100%" style="stop-color:#22c55e;stop-opacity:0" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                
                                <!-- Y-Axis Labels -->
                                <div class="absolute left-0 top-0 h-full flex flex-col justify-between text-xs text-gray-900 font-bold py-2">
                                    <span>$@((maxVal).ToString("N0"))</span>
                                    <span>$@((maxVal * 0.66m).ToString("N0"))</span>
                                    <span>$@((maxVal * 0.33m).ToString("N0"))</span>
                                    <span>$0</span>
                                </div>
                            }
                            else
                            {
                                <div class="flex items-center justify-center h-full text-gray-600">
                                    No data available for the chart
                                </div>
                            }
                        </div>
                    </CardBody>
                </Card>
            </div>

            <!-- Top Selling Products -->
            <div>
                <Card class="shadow-xl border border-gray-200 h-full !bg-white">
                    <div class="bg-white border-b border-gray-200 p-6 pb-4">
                        <div class="flex justify-between items-center">
                            <h5 class="text-lg font-bold text-gray-900 mb-0">Top Products</h5>
                            <a href="/admin/products" class="text-blue-600 text-sm hover:text-blue-700 hover:underline font-bold">View all</a>
                        </div>
                    </div>
                    <CardBody class="p-6 bg-white">
                        <div class="space-y-4">
                            @if (statistics.TopSellingProducts != null && statistics.TopSellingProducts.Any())
                            {
                                @foreach (var product in statistics.TopSellingProducts.Take(5))
                                {
                                    <div class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors">
                                        <div class="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0 shadow-sm">
                                            @if (!string.IsNullOrEmpty(product.ImageUrl))
                                            {
                                                <img src="@product.ImageUrl" class="w-full h-full object-cover rounded-lg" alt="@product.ProductName" />
                                            }
                                            else
                                            {
                                                <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.BoxOpen" class="text-gray-500" />
                                            }
                                        </div>
                                        <div class="flex-1 min-w-0">
                                            <p class="font-bold text-gray-900 mb-0 truncate text-sm">@product.ProductName</p>
                                            <p class="text-gray-600 text-xs mb-0 font-medium">@product.TotalQuantitySold sold</p>
                                        </div>
                                        <div class="text-right">
                                            <p class="font-bold text-gray-900 mb-0 text-sm">$@product.TotalRevenue.ToString("N0")</p>
                                        </div>
                                    </div>
                                }
                            }
                            else
                            {
                                <p class="text-gray-500 text-center py-4">No products data</p>
                            }
                        </div>
                    </CardBody>
                </Card>
            </div>
        </div>

        <!-- Fourth Row: Recent Transactions -->
        <Card class="shadow-xl border border-gray-200 !bg-white">
            <div class="bg-white border-b-2 border-gray-200 p-6">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-6">
                        <span class="@GetTabClass("transactions")" @onclick='() => transactionView = "transactions"'>
                            Recent Transactions
                        </span>
                        <span class="@GetTabClass("pending")" @onclick='() => transactionView = "pending"'>
                            Recent Transfer
                        </span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="relative">
                            <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.Search" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm" />
                            <input type="text" placeholder="Search transactions" class="pl-10 pr-4 py-2 bg-white border-2 border-gray-300 rounded-lg text-sm text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none w-64 shadow-sm" />
                        </div>
                    </div>
                </div>
            </div>
            <CardBody Padding="Padding.Is0">
                <Table Hoverable class="mb-0">
                    <TableHeader>
                        <TableRow class="bg-white border-b-2 border-gray-200">
                            <TableHeaderCell class="px-6 py-4 text-gray-900 font-bold text-sm uppercase tracking-wide">Date</TableHeaderCell>
                            <TableHeaderCell class="px-6 py-4 text-gray-900 font-bold text-sm uppercase tracking-wide">Status</TableHeaderCell>
                            <TableHeaderCell class="px-6 py-4 text-gray-900 font-bold text-sm uppercase tracking-wide">Merchant</TableHeaderCell>
                            <TableHeaderCell class="px-6 py-4 text-gray-900 font-bold text-sm uppercase tracking-wide">Card</TableHeaderCell>
                            <TableHeaderCell class="px-6 py-4 text-gray-900 font-bold text-sm uppercase tracking-wide text-right">Amount</TableHeaderCell>
                        </TableRow>
                    </TableHeader>
                    <TableBody class="bg-white divide-y divide-gray-200">
                        @if (recentOrders != null && recentOrders.Any())
                        {
                            @foreach (var order in recentOrders.Take(10))
                            {
                                <TableRow class="bg-white hover:bg-gray-100 transition-colors">
                                    <TableRowCell class="px-6 py-4">
                                        <div>
                                            <span class="text-gray-900 font-bold text-sm">@order.OrderDate.ToString("MMM dd, yyyy")</span>
                                            <span class="text-gray-600 text-xs block mt-0.5 font-medium">@order.OrderDate.ToString("h:mm tt")</span>
                                        </div>
                                    </TableRowCell>
                                    <TableRowCell class="px-6 py-4">
                                        <Badge Color="@GetStatusColor(order.Status)" class="px-3 py-1.5 rounded-full">
                                            <span class="flex items-center gap-1.5">
                                                <span class="w-2 h-2 rounded-full @GetStatusDotClass(order.Status)"></span>
                                                <span class="font-bold text-xs">@order.Status</span>
                                            </span>
                                        </Badge>
                                    </TableRowCell>
                                    <TableRowCell class="px-6 py-4">
                                        <div class="flex items-center gap-3">
                                            <div class="w-9 h-9 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-md">
                                                @(order.Customer?.Name?.Substring(0, 1).ToUpper() ?? "G")
                                            </div>
                                            <span class="text-gray-900 font-bold text-sm">@(order.Customer?.Name ?? "Guest")</span>
                                        </div>
                                    </TableRowCell>
                                    <TableRowCell class="px-6 py-4">
                                        <div>
                                            <span class="text-gray-900 font-bold text-sm">Order @order.OrderId</span>
                                            <span class="text-gray-600 text-xs block mt-0.5 font-medium">** @order.OrderId.ToString().Substring(Math.Max(0, order.OrderId.ToString().Length - 4))</span>
                                        </div>
                                    </TableRowCell>
                                    <TableRowCell class="px-6 py-4 text-right">
                                        <span class="font-bold text-gray-900 text-sm">$@order.TotalAmount.ToString("N0")</span>
                                    </TableRowCell>
                                </TableRow>
                            }
                        }
                        else
                        {
                            <TableRow class="bg-white">
                                <TableRowCell ColumnSpan="5" class="text-center py-8 text-gray-600">
                                    No recent transactions found
                                </TableRowCell>
                            </TableRow>
                        }
                    </TableBody>
                </Table>
            </CardBody>
            <div class="bg-gray-50 border-t border-gray-200 p-4">
                <div class="flex justify-center">
                    <Button Color="Color.Primary" Size="Size.Small" To="/admin/orders" Type="ButtonType.Link" Class="!bg-blue-600 !text-white hover:!bg-blue-700 shadow-md">
                        View All Orders <Icon Name="Blazorise.Icons.FontAwesome.FontAwesomeIcons.ArrowRight" class="ml-2" />
                    </Button>
                </div>
            </div>
        </Card>
    }
</div>

@code {
    private DashboardStatisticsDto? statistics;
    private List<Order>? recentOrders;
    private bool isLoading = true;
    private string chartView = "revenue";
    private string transactionView = "transactions";

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
    }

    private async Task LoadData()
    {
        isLoading = true;
        
        try
        {
            statistics = await StatisticsService.GetDashboardStatisticsAsync(30);
            
            recentOrders = await DbContext.Orders
                .Include(o => o.Customer)
                .Include(o => o.Payments)
                .OrderByDescending(o => o.OrderDate)
                .Take(10)
                .ToListAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading dashboard data: {ex.Message}");
        }
        
        isLoading = false;
    }

    private async Task RefreshData()
    {
        await LoadData();
    }

    private int GetProgressValue(int current, int max)
    {
        if (max <= 0) return 0;
        var result = (int)Math.Round((current / (decimal)max) * 100);
        return Math.Min(result, 100);
    }

    private string GetChartButtonClass(string view)
    {
        return chartView == view ? "!bg-blue-600 !text-white shadow-md" : "!bg-white !text-gray-900 !border-gray-300 hover:!bg-gray-100";
    }

    private string GetTabClass(string tab)
    {
        var baseClass = "text-lg font-bold cursor-pointer pb-2 transition-colors";
        return transactionView == tab 
            ? $"{baseClass} text-blue-600 border-b-2 border-blue-600" 
            : $"{baseClass} text-gray-600 hover:text-gray-900";
    }

    private Color GetStatusColor(string status) => status.ToLower() switch
    {
        "pending" => Color.Warning,
        "completed" or "paid" => Color.Success,
        "cancelled" or "canceled" => Color.Danger,
        "processing" => Color.Info,
        _ => Color.Secondary
    };

    private string GetStatusDotClass(string status) => status.ToLower() switch
    {
        "pending" => "bg-yellow-500",
        "completed" or "paid" => "bg-green-500",
        "cancelled" or "canceled" => "bg-red-500",
        "processing" => "bg-blue-500",
        _ => "bg-gray-500"
    };
}
